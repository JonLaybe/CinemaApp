<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="CinemaApp.MainPage"
             xmlns:ffSvg="clr-namespace:FFImageLoading.Svg.Maui;assembly=FFImageLoading.Compat.Svg.Maui"
             xmlns:vm="clr-namespace:СinemaApp.MVVM.ViewModels"
             xmlns:modelsFilm="clr-namespace:CinemaApp.Core.Models.Film;assembly=CinemaApp.Core"
             xmlns:localModel="clr-namespace:CinemaApp.MVVM.Models.Entity"
             x:DataType="vm:MainViewModel">

    <Grid Margin="5" RowSpacing="10">
        <Grid.RowDefinitions>
            <RowDefinition Height="50"/>
            <RowDefinition Height="150"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <Grid BackgroundColor="{StaticResource LogoSideBar}" Padding="5, 3">
            <ffSvg:SvgCachedImage Source="Logo.svg" HorizontalOptions="Start"/>
        </Grid>
        <Grid Grid.Row="1">
            <StackLayout Orientation="Vertical">
                <Border Stroke="{StaticResource StrokeSurch}" Background="{StaticResource BackgroundSurch}">
                    <Border.StrokeShape>
                        <RoundRectangle CornerRadius="10"/>
                    </Border.StrokeShape>
                    <Grid Margin="3" RowSpacing="1" VerticalOptions="Center">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="50"/>
                        </Grid.ColumnDefinitions>
                        <Entry Style="{StaticResource EntrySurch}" Text="{Binding TextSurch}"
                               Placeholder="Поиск фильм, актер"/>
                        <ffSvg:SvgCachedImage Grid.Column="1" Source="GlassSurch.svg" WidthRequest="20">
                            <ffSvg:SvgCachedImage.GestureRecognizers>
                                <TapGestureRecognizer
                                    Command="{Binding Source={RelativeSource AncestorType={x:Type vm:MainViewModel}}, Path=SurchButton}"/>
                            </ffSvg:SvgCachedImage.GestureRecognizers>
                        </ffSvg:SvgCachedImage>
                    </Grid>
                </Border>
                <CollectionView ItemsSource="{Binding ListGenres}">
                    <CollectionView.ItemsLayout>
                        <GridItemsLayout Orientation="Horizontal" Span="2"/>
                    </CollectionView.ItemsLayout>
                    <CollectionView.ItemTemplate>
                        <DataTemplate x:DataType="localModel:ClientGenre">
                            <StackLayout Orientation="Horizontal">
                                <CheckBox x:Name="checkBoxGenre" IsChecked="{Binding IsSelected}"/>
                                <Label FontSize="16" Text="{Binding Name}" VerticalTextAlignment="Center"/>
                            </StackLayout>
                        </DataTemplate>
                    </CollectionView.ItemTemplate>
                </CollectionView>
            </StackLayout>
        </Grid>
        <Grid Grid.Row="2">
            <CollectionView ItemsSource="{Binding ListFilm}">
                <CollectionView.ItemsLayout>
                    <LinearItemsLayout Orientation="Vertical" ItemSpacing="5" />
                </CollectionView.ItemsLayout>
                <CollectionView.ItemTemplate>
                    <DataTemplate x:DataType="modelsFilm:FilmDto">
                        <Border Stroke="Gray" Padding="5">
                            <Border.StrokeShape>
                                <RoundRectangle CornerRadius="10"/>
                            </Border.StrokeShape>
                            <StackLayout Orientation="Horizontal" Margin="5">
                                <StackLayout.GestureRecognizers>
                                    <TapGestureRecognizer
                                        NumberOfTapsRequired="2"
                                            Command="{Binding Source={RelativeSource AncestorType={x:Type vm:MainViewModel}}, Path=SelectedGenreClick}"
                                            CommandParameter="{Binding Id}"/>
                                </StackLayout.GestureRecognizers>
                                <Grid WidthRequest="72" HeightRequest="108" Background="{StaticResource BackgroundPreviewMove}">
                                    <ffSvg:SvgCachedImage Source="LogoPlay.svg" WidthRequest="25"/>
                                </Grid>
                                <Label Text="{Binding Name}" Margin="5, 0" FontFamily="OpenSansSemibold"/>
                            </StackLayout>
                        </Border>
                    </DataTemplate>
                </CollectionView.ItemTemplate>
            </CollectionView>
        </Grid>
    </Grid>
</ContentPage>
